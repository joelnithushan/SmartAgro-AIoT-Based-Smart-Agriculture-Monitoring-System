import React, { useEffect, useState, useCallback } from 'react';import { useNavigate, useLocation } from 'react-router-dom';import { useAuth } from '../contexts/AuthContext';import toast from 'react-hot-toast';import AdminLayout from './AdminLayout';import AdminDashboard from '../pages/admin/AdminDashboard';import OrderManagement from '../pages/admin/OrderManagement';import UserManagement from '../pages/admin/UserManagement';import DeviceManagement from '../pages/admin/DeviceManagement';import FarmDataManagement from '../pages/admin/FarmDataManagement';import AdminProfile from '../pages/admin/AdminProfile';const AdminRouteHandler = () => {  const { user, loading: authLoading } = useAuth();  const navigate = useNavigate();  const location = useLocation();  const [userRole, setUserRole] = useState(null);  const [roleLoading, setRoleLoading] = useState(true);  const checkUserRole = useCallback(async () => {    console.log('checkUserRole called with user:', user?.email);    if (!user) {      console.log('No user found, setting role loading to false');      setRoleLoading(false);      return;    }    try {      setRoleLoading(true);      console.log('Checking if user is admin:', user.email);      if (user.email !== 'joelnithushan6@gmail.com') {        console.log('Access denied: User is not admin');        toast.error('Access denied. Admin access required.');        navigate('/user/dashboard');        return;      }      console.log('User is admin, setting role');      setUserRole('admin');    } catch (error) {      console.error('Error checking user role:', error);      navigate('/user/dashboard');    } finally {      setRoleLoading(false);    }  }, [user, navigate]);  useEffect(() => {    console.log('useEffect triggered, calling checkUserRole');    checkUserRole();  }, [checkUserRole]);  if (authLoading || roleLoading) {    console.log('Showing loading screen, authLoading:', authLoading, 'roleLoading:', roleLoading);    return (      <div className="min-h-screen flex items-center justify-center bg-gray-50">        <div className="text-center">          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"></div>          <p className="mt-4 text-gray-600">Loading admin panel...</p>        </div>      </div>    );  }  if (!user) {    console.log('No user, redirecting to login');    navigate('/login');    return null;  }  if (userRole !== 'admin') {    console.log('User is not admin, redirecting to user dashboard');    navigate('/user/dashboard');    return null;  }  const renderAdminRoute = () => {    const path = location.pathname;    console.log('Rendering admin route for path:', path);    switch (path) {      case '/admin/dashboard':        return <AdminDashboard />;      case '/admin/orders':        return <OrderManagement />;      case '/admin/users':        return <UserManagement />;      case '/admin/devices':        return <DeviceManagement />;      case '/admin/farm-data':        return <FarmDataManagement />;      case '/admin/profile':        return <AdminProfile />;      default:        return <AdminDashboard />;    }  };  console.log('Rendering AdminLayout with userRole:', userRole);  return (    <AdminLayout>      {renderAdminRoute()}    </AdminLayout>  );};export default AdminRouteHandler;